adduser test8

## start a new node
gnoland start

## add bar.gno package located in $WORK directory as gno.land/r/bar
gnokey maketx addpkg -pkgdir $WORK -pkgpath gno.land/r/bar -gas-fee 1000000ugnot -gas-wanted 2000000 -broadcast -chainid=tendermint_test test8

## execute Render
withuser test8 gnokey maketx call -pkgpath gno.land/r/bar -func Render -args 'USERADDRESS' -gas-fee 1000000ugnot -gas-wanted 2000000 -broadcast -chainid=tendermint_test test8

## compare render
stdout 'hello from'
stdout 'OK!'
stdout 'GAS WANTED: 200000'
stdout 'GAS USED: '

# should fail if user is added after node is started
! adduser test5
stderr '"adduser" error: adduser must be used before starting node'

-- bar.gno --
package bar

func Render(path string) string {
 	return "hello from " + path
}
